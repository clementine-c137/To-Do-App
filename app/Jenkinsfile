pipeline {
  agent any
    //docker { image 'node:12-alpine' }
  environment {
    DOCKER_PWD = credentials('docker-pwd')
  }
  stages {
    stage('Build-img') {
      steps {
        sh 'ls -l'
        sh 'pwd'
        sh 'cd app && docker build -t tbancila/tali-app:latest .'
      }
    }
    stage('Push-img') {
      steps {
        //withCredentials([string(credentialsId: 'docker-pwd', variable: 'password')]) {
          sh 'docker login -u "tbancila" -p "$DOCKER_PWD" docker.io'
        }
        sh 'docker push tbancila/tali-app:latest'
      }
    }
  }
}
